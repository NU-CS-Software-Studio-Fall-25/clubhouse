<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <%= form_with(model: event, class: "card shadow-sm") do |form| %>
        <div class="card-body">
          <%= form.hidden_field :club_id, value: event.club_id || params[:club_id] %>

          <div class="mb-3" data-character-count="true" data-character-count-max="50">
            <%= form.label :name, class: "form-label" %>
            <%= form.text_field :name, class: "form-control", maxlength: 50, data: { "character-count-role": "input" } %>
            <div class="form-text text-end">
              <span data-character-count-role="counter"></span>
            </div>
          </div>

          <div class="mb-3">
            <%= form.label :date, class: "form-label" %>
            <%= form.datetime_field :date, class: "form-control" %>
          </div>

          <div class="mb-3">
            <%= form.label :location, class: "form-label" %>
            <%= form.text_field :location, class: "form-control" %>
          </div>

          <div class="mb-3" data-character-count="true" data-character-count-max="300">
            <%= form.label :description, class: "form-label" %>
            <%= form.text_area :description, class: "form-control", rows: 4, maxlength: 300, data: { "character-count-role": "input" } %>
            <div class="d-flex justify-content-between form-text">
              <span>Optional: provide details about the event.</span>
              <span data-character-count-role="counter"></span>
            </div>
          </div>

          <div class="mb-3">
            <div class="form-check">
              <%= form.check_box :recurring, class: "form-check-input", id: "event_recurring" %>
              <%= form.label :recurring, "Recurring weekly", class: "form-check-label" %>
            </div>
          </div>

          <div class="mb-3 d-none" id="event_end_date_field">
            <%= form.label :end_date, "End Date", class: "form-label" %>
            <%= form.date_field :end_date, class: "form-control" %>
            <div class="form-text">Events will be created weekly until this date</div>
          </div>

          <div class="d-grid">
            <%= form.submit class: "btn btn-primary" %>
          </div>

          <script>
            (() => {
              const recurringCheckbox = document.getElementById('event_recurring');
              const endDateField = document.getElementById('event_end_date_field');

              const toggleEndDateField = () => {
                if (recurringCheckbox && endDateField) {
                  endDateField.classList.toggle('d-none', !recurringCheckbox.checked);
                }
              };

              // Initial setup
              toggleEndDateField();

              // Add event listeners
              recurringCheckbox?.addEventListener('change', toggleEndDateField);
            })();
          </script>
        </div>
      <% end %>
    </div>
  </div>
</div>
  
